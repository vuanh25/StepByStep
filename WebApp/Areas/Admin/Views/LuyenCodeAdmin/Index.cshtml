@model WebApp.Models.Entities.LuyenCode

@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
}


<link href="~/Public/css/LuyenCodeAdmin.css" rel="stylesheet" />
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />


<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
    <!-- Main content -->
    <section class="content">

        <!-- Default box -->
        <div class="card font container">
            <div class="card-header can_giua">
                <div class="row">
                    <div class="">
                        <strong>DANH SÁCH BÀI LUYỆN TẬP</strong>
                    </div>
                    
                </div>
            </div>
            <button class="btn btn-success mg-tb" id="btnAdd"  style="width:10.3em">
                Thêm bài tập
            </button>
            <table>
                <thead>
                    <tr class="mau_cho_cot ">
                        <th class="pd-l">Tên bài tập</th>
                        <th>Yêu thích</th>
                        <th>Ngôn ngữ</th>
                        <th>Cấp độ</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="BT" class="font chieu_cao_dong ">

                </tbody>
            </table>
            <!-- /.card-body -->

        </div>
        <!-- /.card -->

    </section>
    <!-- /.content -->
</div>

                                        @*THÊM*@


@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
<div class="modal" tabindex="-1" role="dialog" id="modalBT">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="panel panel-primary font ">
                <div class="panel-heading can_giua">Thêm bài tập vào danh sách LUYỆN CODE</div>
                <div class="panel-body pd-lr">

                    <div class="form-group">
                        <label>Tên bài tập</label>
                        <input type="text" class="form-control" id="TenLuyenTap" placeholder="Tên bài tập">
                    </div>
                    <div class="form-group">
                        <label>Yêu thích</label>
                        <input type="text" class="form-control" id="YeuThich" placeholder="Số lượng yêu thích">
                    </div>

                    @*<script type="text/javascript">
                        var NgonNgu = { "C_Cplus": 0, "CSharp": 1, "Java": 2 };
                        $(function () {
                            $("#ddlColors").change(function () {
                                switch (parseInt($(this).val())) {
                                    case NgonNgu.C_Cplus:
                                        alert("C_Cplus");
                                        break;
                                    case NgonNgu.CSharp:
                                        alert("CSharp");
                                        break;
                                    case NgonNgu.Java:
                                        alert("Java");
                                        break;
                                }
                            });
                        });
                    </script>*@

                    <div class="form-group" style="display:inline-flex">
                        <label class="pd-r">Ngôn ngữ</label>
                        <select id="NgonNgu">
                            <option value="0">C/C++</option>
                            <option value="1">C#</option>
                            <option value="2">Java</option>
                        </select>
                     @*   <input type="text" class="form-control" id="NgonNgu" placeholder="Ngôn ngữ lập trình">*@
                    
                    
                    @*<script type="text/javascript">
                        var NgonNgu = { "De": 0, "TrungBinh": 1, "Kho": 2,"SieuKho" : 3 };
                        $(function () {
                            $("#ddlColors").change(function () {
                                switch (parseInt($(this).val())) {
                                    case NgonNgu.C_Cplus:
                                        alert("C_Cplus");
                                        break;
                                    case NgonNgu.CSharp:
                                        alert("CSharp");
                                        break;
                                    case NgonNgu.Java:
                                        alert("Java");
                                        break;
                                }
                            });
                        });
                    </script>*@
                    
                    </div>
                    <div class="form-group mg-l-30" style="display: inline-flex;">
                        <label class="pd-r">Cấp độ</label>
                        <select id="CapDo">
                            <option value="0">Dễ</option>
                            <option value="1">Trung bình</option>
                            <option value="2">Khó</option>
                            <option value="3">Siêu khó</option>
                        </select>

                        @*<input type="text" class="form-control " id="CapDo" placeholder="Mức độ bài tập">*@
                    </div>


                </div>
            </div>
            <div class="modal-body">
                <p>Modal body text goes here.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnSubmit">Lưu</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>
}



@section scripts {

    <script>
        $(document).ready(function () {
            TaiDsBaiLuyen();
        })
        // Chỉnh sửa chi tiết
        $(document).on('click', "button[name='view']", function () {
            let idBT = $(this).closet('tr').find('.name').attr('id');
            alert(idBT);
        });

        // Thêm mới
        $('#btnSubmit').click(function () {
            let TenBaiTap = $('#TenLuyenTap').val().trim();
            let YeuThich = $('#YeuThich').val().trim();
            let NgonNgu = $('#NgonNgu').val().trim();
            let CapDo = $('#CapDo').val().trim();

            if (TenBaiTap.length == 0 || YeuThich.length == 0 || NgonNgu.length == 0 || CapDo.length == 0) {
                alert('Vui lòng điền đây đủ nội dung!');
                return;
            }

            // dùng ajax theem moi BT
            $.ajax({
                url: '/LuyenCodeAdmin/AddBT',
                type: 'post',
                data: {
                    tenBT: TenBaiTap,
                    yeuThich: YeuThich,
                    ngonNgu: NgonNgu,
                    doKho: CapDo
                },
                success: function (data) {
                    if (data.code == 200) {
                        alert(data.msg);
                        TaiDsBaiLuyen();
                        $('#TenLuyenTap').val('');
                        $('#YeuThich').val('');
                    } else {
                        alert(data.msg);
                    }
                }
            });
        });

        $('#btnAdd').click(function () {
            $('#modalBT').modal();
        })

        
        // Load danh sách
        function TaiDsBaiLuyen() {
            $.ajax({
            url: '/LuyenCodeAdmin/DsBT',
            type: 'get',
                success: function (data) {
                //    load lại không chèn cũ;
                    $('#BT').empty();

                if (data.code == 200) {
                    $.each(data.ds, function (k, v) {

                        let tr = '<tr>'
                        tr += '<td class="pd-l">' + v.TenLuyenTap + '</td>';
                        tr += '<td>' + v.YeuThich + '</td>';
                        tr += '<td>' + v.NgonNgu + '</td>';
                        tr += '<td>' + v.CapDo + '</td>';
                        tr += '<td>';

                        tr += '<button class = "btn btn-primary">' + 'Thêm' + '</button>';
                        tr += '<button class = "btn btn-warning mg-lr">' + 'Sửa' + '</button>';
                        tr += '<button class = "btn btn-danger">' + 'Xóa' + '</button>';
                             
                        tr += '</td>';
                        tr += '</td>';


                        $('#BT').append(tr);

                    })
                }
                }
            })
        }

        
    </script>    
    
    
}





